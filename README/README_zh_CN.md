# Logic Vision

## 特征检测器

本项目中已经完整集成了OneFormer全景分割模型特征检测器和YOLO分割模型特征检测器。
特征检测器的主要功能是利用不同的分割模型，对输入的图像进行特征检测，提取出图像中的特征信息。
在完成特征检测后，将提取出的特征信息序列化为标准输出的格式，以便在后续中用于训练和推理LTN模型。

## Logic Tensor Network
对于逻辑张量网络，项目使用LTNTorch库进行实现。
这个逻辑张量网络的工作模式如下：
1. 将已经序列化的特征检测网络输出全部转换为ltn.Constant对象。
2. 将所有的ltn.Constant对象输入到LTNTorch的LTN模型中。
3. 使用一阶逻辑公式定义模型的约束条件。
4. 使用LTNTorch的训练器进行模型的训练。
5. 使用训练好的模型进行推理。

## 示例
特征检测器输出一个模型的序列化信息
使用一阶逻辑公式定义模型的约束条件，例如“所有的人都在海边”
使用LTNTorch的训练器进行模型的训练，使模型的输出为人和海边的交集
推理的结果是，输出图像中包含人和海边的遮罩、边界框等信息

## 训练方式
DataLoader从数据集中加载数据，并且按照TOML文件中给出的Batch Size进行批量处理。
训练器将批量数据传入特征检测器中，得到特征检测器的输出。
将特征检测器的输出序列化为标准输出的格式，传入LTNTorch的LTN模型中。
使用一阶逻辑公式定义模型的约束条件，使用LTNTorch的训练器进行模型的训练。
训练完成后，使用训练好的模型进行推理。

## 推理方式
将单张图像输入到特征检测器中，得到特征检测器的输出。
将特征检测器的输出序列化为标准输出的格式，传入LTNTorch的LTN模型中。
使用训练好的模型进行推理，得到输出图像中包含人和海边的遮罩、边界框等信息。
结合原始图像和推理结果，得到最终的输出图像。


## 数据集
本项目中仅使用VOC2012数据集中的图像。
项目只需要数据集中的图像，原因是用于训练LTN的数据均来自于特征检测器的输出，而特征检测器的输出是序列化的特征信息，不需要标注数据。
