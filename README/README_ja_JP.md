[![English](https://cdn3.iconfinder.com/data/icons/142-mini-country-flags-16x16px/32/flag-usa2x.png)](/README.md)
[![FranÃ§ais](https://cdn3.iconfinder.com/data/icons/142-mini-country-flags-16x16px/32/flag-france2x.png)](/README/README_fr_FR.md)
[![ä¸­æ–‡](https://cdn3.iconfinder.com/data/icons/142-mini-country-flags-16x16px/32/flag-china2x.png)](/README/README_zh_CN.md)
[![æ—¥æœ¬èª](https://cdn3.iconfinder.com/data/icons/142-mini-country-flags-16x16px/32/flag-japan2x.png)](/README/README_ja_JP.md)

# ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯ãƒ»ãƒ†ãƒ³ã‚½ãƒ«ãƒ»ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç”¨ã„ãŸè¦–è¦šã‚·ãƒ¼ãƒ³ã®ç†è§£ ğŸš€ ğŸ¤– 

[![Python 3.12](https://img.shields.io/badge/Python-3.12-blue?style=flat-square)](https://www.python.org)
[![CUDA 12.4](https://img.shields.io/badge/CUDA-12.4-red?style=flat-square)](https://developer.nvidia.com/cuda-toolkit)
[![LTNTorch](https://img.shields.io/badge/Project-LTNTorch-9cf?style=flat-square)](https://github.com/ltntorch)
[![Visual Genome](https://img.shields.io/badge/Data-Visual%20Genome-yellow?style=flat-square)](https://visualgenome.org)
[![YOLO](https://img.shields.io/badge/Detection-YOLO-orange?style=flat-square)](https://github.com/ultralytics/ultralytics)
[![OneFormer](https://img.shields.io/badge/Segmentation-OneFormer-brightgreen?style=flat-square)](https://github.com/isl-org/OneFormer)

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨ãƒ­ã‚¸ãƒƒã‚¯ãƒ†ãƒ³ã‚½ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’çµ„ã¿åˆã‚ã›ã€ä¸€éšè«–ç†å¼ã¨å¤šå±¤ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã‚ˆã‚Šã€ç”»åƒä¸­ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é–¢ä¿‚ã«é–¢ã™ã‚‹æ¨è«–ã‚’å®Ÿç¾ã—ã€ç”»åƒã‚³ãƒ³ãƒ†ãƒ³ãƒ„è§£æã®å‘ä¸Šã‚’ç›®æŒ‡ã—ã¾ã™ã€‚âœ¨

---

## ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

1.**ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨ç‰¹å¾´æŠ½å‡º**ï¼šYOLOv8 / OneFormerã‚’ä½¿ç”¨
2.**å¯¾è±¡ç‰©ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°**ï¼šé–¢å¿ƒã®ã‚ã‚‹å¯¾è±¡ç‰©ã®ä¿æŒ
3.**è«–ç†ãƒ†ãƒ³ã‚½ãƒ«ã®ç”Ÿæˆ**ï¼šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒšã‚¢ã®ãƒ‡ã‚«ãƒ«ãƒˆç©ã§è«–ç†ãƒ†ãƒ³ã‚½ãƒ«ã‚’ç”Ÿæˆã™ã‚‹
4.**è«–ç†çš„æ¨è«–**ï¼šè«–ç†ãƒ†ãƒ³ã‚½ãƒ«ã‚’ä½¿ã£ãŸé–¢ä¿‚è¿°èªæ¨è«–
5.**çµæœå‡ºåŠ›**ï¼šæ¨è«–çµæœã®å‡ºåŠ›


## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰

### ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç’°å¢ƒï¼ˆUbuntu 22.04ï¼‰
```bash
pip install -r requirements.train.txt
```

### æ¨è«–ç’°å¢ƒï¼ˆmacOS 15.3ï¼‰
```bash
pip install -r requirements.inference.txt
```

YOLOã¨OneFormerã®è¨“ç·´æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œæ™‚ã«è‡ªå‹•çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ã€‚

## ä½¿ç”¨ã«é–¢ã™ã‚‹ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ä¾‹
```Python
from utils.Trainer import trainer
import tomllib

with open("config.toml", "rb") as f.
    config = tomllib.load(f)

predicates = ["in", "on", "next to", "on top of", "near", "under"]
params = config["Train"]

for pred in predicates:
    trainer(
        pos_predicate=pred,
        neg_predicates=[p for p in predicates if p ! = pred],
        epoches=params["epochs"],
        batch_size=params["batch_size"],
        lr=params["lr"]
    )
```

### æ¨è«–ã®ä¾‹
```Python
from PIL import Image
from utils.Inferencer import Inferencer
from utils.Draw import draw_and_save_result

inferencer = Inferencer(subj_class="person", obj_class="sky", predicate="near")
image = Image.open("path_to_image.jpg")
result = inferencer.inference_single(image)

if result.get("exists", True): if result.get("exists", True).
    draw_and_save_result(image, result, "result.jpg")
```

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
[Visual Genome](https://homes.cs.washington.edu/~ranjay/visualgenome/index.html)ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®äººé–“é–¢ä¿‚ã¨ç”»åƒãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ã€ç”»åƒæƒ…å ±ã¨ç‰¹å¾´ãƒšã‚¢æƒ…å ±ã‚’æŠ½å‡ºã—ãŸã€‚

---